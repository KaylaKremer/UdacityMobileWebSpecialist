'use strict';

var restaurant = void 0;
var map = void 0;
var liveMap = false;
var initLoad = true;

/**
 * Initialize Google map, called from HTML.
 */
window.initMap = function () {
	fetchRestaurantFromURL(function (error, restaurant) {
		if (error) {
			// Got an error!
			console.error(error, restaurant);
		} else {
			fillBreadcrumb();
		}
	});
};

/**
 * Get current restaurant from page URL.
 */
var fetchRestaurantFromURL = function fetchRestaurantFromURL(callback) {
	if (self.restaurant) {
		// restaurant already fetched!
		callback(null, self.restaurant);
		return;
	}
	var id = getParameterByName('id');
	if (!id) {
		// no id found in URL
		error = 'No restaurant id in URL';
		callback(error, null);
	} else {
		DBHelper.fetchRestaurantById(id, function (error, restaurant) {
			self.restaurant = restaurant;
			if (!restaurant) {
				console.error(error);
				return;
			}
			fillRestaurantHTML();
			callback(null, restaurant);
		});
	}
};

/**
 * Create restaurant HTML and add it to the webpage
 */

/* If a live map isn't already enabled, removes the static map image and replaces it with a live Google Map. */
var getLiveMap = function getLiveMap() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	if (liveMap) {
		return;
	} else {
		var staticMapImg = document.getElementById('static-map-img');
		staticMapImg.parentNode.removeChild(staticMapImg);
		self.map = new google.maps.Map(document.getElementById('map'), {
			zoom: 16,
			center: self.restaurant.latlng,
			scrollwheel: false
		});
		addMarkerToMap();
		liveMap = true;
	}
};

var fillRestaurantHTML = function fillRestaurantHTML() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	/* Loads a static map image if it's the initial page load. Adds a click event listener so that when the user clicks on the map, it removes the static map image and loads a live map in its place. */
	if (initLoad) {
		var staticMap = DBHelper.staticImageForMapRestaurantInfo(self.restaurant);
		var _map = document.getElementById('map');
		var staticMapImg = document.createElement('img');
		staticMapImg.id = 'static-map-img';
		staticMapImg.style.width = _map.clientWidth + 'px';
		staticMapImg.style.height = _map.clientHeight + 'px';
		staticMapImg.src = staticMap;
		staticMapImg.addEventListener('click', function () {
			getLiveMap(self.restaurant);
		});
		_map.appendChild(staticMapImg);
		addMarkerToMap();
		initLoad = false;
	} else {
		//DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);
		addMarkerToMap();
	}
	var name = document.getElementById('restaurant-name');
	name.innerHTML = restaurant.name;

	var address = document.getElementById('restaurant-address');
	address.innerHTML = restaurant.address;

	/* Lazy loads small or large version of restaurant image based on data-srcset and auto data-sizes. Also dynamically sets alt and title text of the image. */
	var image = document.getElementById('restaurant-img');
	image.className = 'restaurant-img lazyload';

	/* Backup code without lazy load
 image.src = DBHelper.largeImageUrlForRestaurant(restaurant);
 image.srcset = `${DBHelper.smallImageUrlForRestaurant(restaurant)} 400w, ${DBHelper.largeImageUrlForRestaurant(restaurant)} 800w`;
 image.sizes = '50vw'; */
	image.setAttribute('data-src', DBHelper.smallImageUrlForRestaurant(restaurant) + ' 400w');
	image.setAttribute('data-srcset', DBHelper.smallImageUrlForRestaurant(restaurant) + ' 400w, ' + DBHelper.largeImageUrlForRestaurant(restaurant) + ' 800w');
	image.setAttribute('data-sizes', 'auto');
	image.title = '' + restaurant.name;
	image.alt = restaurant.name + ' in ' + restaurant.neighborhood + ' - ' + restaurant.cuisine_type + ' restaurant';

	var cuisine = document.getElementById('restaurant-cuisine');
	cuisine.innerHTML = restaurant.cuisine_type;

	// fill operating hours
	if (restaurant.operating_hours) {
		fillRestaurantHoursHTML();
	}
	// fill reviews
	fillReviewsHTML();
};

/**
 * Create restaurant operating hours HTML table and add it to the webpage.
 */
var fillRestaurantHoursHTML = function fillRestaurantHoursHTML() {
	var operatingHours = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant.operating_hours;

	var hours = document.getElementById('restaurant-hours');
	for (var key in operatingHours) {
		var row = document.createElement('tr');

		var day = document.createElement('td');
		day.innerHTML = key;
		row.appendChild(day);

		var time = document.createElement('td');
		time.innerHTML = operatingHours[key];
		row.appendChild(time);

		hours.appendChild(row);
	}
};

/**
 * Create all reviews HTML and add them to the webpage.
 */
var fillReviewsHTML = function fillReviewsHTML() {
	var reviews = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant.reviews;

	var container = document.getElementById('reviews-container');
	var title = document.createElement('h2');
	title.innerHTML = 'Reviews';
	container.appendChild(title);

	if (!reviews) {
		var noReviews = document.createElement('p');
		noReviews.innerHTML = 'No reviews yet!';
		container.appendChild(noReviews);
		return;
	}
	var ul = document.getElementById('reviews-list');
	reviews.forEach(function (review) {
		ul.appendChild(createReviewHTML(review));
	});
	container.appendChild(ul);
};

/**
 * Create review HTML and add it to the webpage.
 */
var createReviewHTML = function createReviewHTML(review) {
	var li = document.createElement('li');
	var name = document.createElement('p');
	name.innerHTML = review.name;
	li.appendChild(name);

	var date = document.createElement('p');
	date.innerHTML = review.date;
	li.appendChild(date);

	var rating = document.createElement('p');
	rating.innerHTML = 'Rating: ' + review.rating;
	li.appendChild(rating);

	var comments = document.createElement('p');
	comments.innerHTML = review.comments;
	li.appendChild(comments);

	return li;
};

/**
 * Add restaurant name to the breadcrumb navigation menu
 */
var fillBreadcrumb = function fillBreadcrumb() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	var breadcrumb = document.getElementById('breadcrumb');
	var li = document.createElement('li');
	li.innerHTML = restaurant.name;

	//Set ARIA attributes so screenreader knows its on the current page for the restaurant in the breadcrumb trail.
	li.setAttribute('aria-label', restaurant.name);
	li.setAttribute('aria-describedby', 'breadcrumb-description');
	li.setAttribute('tabindex', '0');

	//Dynamically set title attribute
	li.title = restaurant.name;
	breadcrumb.appendChild(li);
};

/**
 * Get a parameter by name from page URL.
 */
var getParameterByName = function getParameterByName(name, url) {
	if (!url) url = window.location.href;
	name = name.replace(/[\[\]]/g, '\\$&');
	var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
	    results = regex.exec(url);
	if (!results) return null;
	if (!results[2]) return '';
	return decodeURIComponent(results[2].replace(/\+/g, ' '));
};

/**
 * Add marker for current restaurant to the map.
 */
var addMarkerToMap = function addMarkerToMap() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	// Add marker to the map
	var marker = DBHelper.mapMarkerForRestaurant(restaurant, self.map);
	google.maps.event.addListener(marker, 'click', function () {
		window.location.href = marker.url;
	});
	self.markers.push(marker);
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwibGl2ZU1hcCIsImluaXRMb2FkIiwid2luZG93IiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJlcnJvciIsImNvbnNvbGUiLCJmaWxsQnJlYWRjcnVtYiIsImNhbGxiYWNrIiwic2VsZiIsImlkIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiREJIZWxwZXIiLCJmZXRjaFJlc3RhdXJhbnRCeUlkIiwiZmlsbFJlc3RhdXJhbnRIVE1MIiwiZ2V0TGl2ZU1hcCIsInN0YXRpY01hcEltZyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiem9vbSIsImNlbnRlciIsImxhdGxuZyIsInNjcm9sbHdoZWVsIiwiYWRkTWFya2VyVG9NYXAiLCJzdGF0aWNNYXAiLCJzdGF0aWNJbWFnZUZvck1hcFJlc3RhdXJhbnRJbmZvIiwiY3JlYXRlRWxlbWVudCIsInN0eWxlIiwid2lkdGgiLCJjbGllbnRXaWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsInNyYyIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHBlbmRDaGlsZCIsIm5hbWUiLCJpbm5lckhUTUwiLCJhZGRyZXNzIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzZXRBdHRyaWJ1dGUiLCJzbWFsbEltYWdlVXJsRm9yUmVzdGF1cmFudCIsImxhcmdlSW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwidGl0bGUiLCJhbHQiLCJuZWlnaGJvcmhvb2QiLCJjdWlzaW5lX3R5cGUiLCJjdWlzaW5lIiwib3BlcmF0aW5nX2hvdXJzIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwidGltZSIsInJldmlld3MiLCJjb250YWluZXIiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJjcmVhdGVSZXZpZXdIVE1MIiwicmV2aWV3IiwibGkiLCJkYXRlIiwicmF0aW5nIiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwidXJsIiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsInJlZ2V4IiwiUmVnRXhwIiwicmVzdWx0cyIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJtYXJrZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiZXZlbnQiLCJhZGRMaXN0ZW5lciIsIm1hcmtlcnMiLCJwdXNoIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLG1CQUFKO0FBQ0EsSUFBSUMsWUFBSjtBQUNBLElBQUlDLFVBQVUsS0FBZDtBQUNBLElBQUlDLFdBQVcsSUFBZjs7QUFFQTs7O0FBR0FDLE9BQU9DLE9BQVAsR0FBaUIsWUFBTTtBQUN0QkMsd0JBQXVCLFVBQUNDLEtBQUQsRUFBUVAsVUFBUixFQUF1QjtBQUM3QyxNQUFJTyxLQUFKLEVBQVc7QUFDVjtBQUNBQyxXQUFRRCxLQUFSLENBQWNBLEtBQWQsRUFBcUJQLFVBQXJCO0FBQ0EsR0FIRCxNQUdPO0FBQ05TO0FBQ0E7QUFDRCxFQVBEO0FBUUEsQ0FURDs7QUFXQTs7O0FBR0EsSUFBTUgseUJBQXlCLFNBQXpCQSxzQkFBeUIsQ0FBQ0ksUUFBRCxFQUFjO0FBQzVDLEtBQUlDLEtBQUtYLFVBQVQsRUFBcUI7QUFDcEI7QUFDQVUsV0FBUyxJQUFULEVBQWVDLEtBQUtYLFVBQXBCO0FBQ0E7QUFDQTtBQUNELEtBQU1ZLEtBQUtDLG1CQUFtQixJQUFuQixDQUFYO0FBQ0EsS0FBSSxDQUFDRCxFQUFMLEVBQVM7QUFDUjtBQUNBTCxVQUFRLHlCQUFSO0FBQ0FHLFdBQVNILEtBQVQsRUFBZ0IsSUFBaEI7QUFDQSxFQUpELE1BSU87QUFDTk8sV0FBU0MsbUJBQVQsQ0FBNkJILEVBQTdCLEVBQWlDLFVBQUNMLEtBQUQsRUFBUVAsVUFBUixFQUF1QjtBQUN2RFcsUUFBS1gsVUFBTCxHQUFrQkEsVUFBbEI7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Q0FYRDs7QUFhQTs7O0FBR0EsSUFBTWpELGlCQUFpQixTQUFqQkEsY0FBaUIsR0FBa0M7QUFBQSxLQUFqQzlCLFVBQWlDLHVFQUFwQlcsS0FBS1gsVUFBZTs7QUFDeEQ7QUFDQSxLQUFNcUYsU0FBU3ZFLFNBQVN3RSxzQkFBVCxDQUFnQ3RGLFVBQWhDLEVBQTRDVyxLQUFLVixHQUFqRCxDQUFmO0FBQ0FzQixRQUFPQyxJQUFQLENBQVkrRCxLQUFaLENBQWtCQyxXQUFsQixDQUE4QkgsTUFBOUIsRUFBc0MsT0FBdEMsRUFBK0MsWUFBTTtBQUNwRGpGLFNBQU95RSxRQUFQLENBQWdCQyxJQUFoQixHQUF1Qk8sT0FBT1QsR0FBOUI7QUFDQSxFQUZEO0FBR0FqRSxNQUFLOEUsT0FBTCxDQUFhQyxJQUFiLENBQWtCTCxNQUFsQjtBQUNBLENBUEQiLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnQ7XG5sZXQgbWFwO1xubGV0IGxpdmVNYXAgPSBmYWxzZTtcbmxldCBpbml0TG9hZCA9IHRydWU7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcblx0ZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcblx0XHRpZiAoZXJyb3IpIHsgXG5cdFx0XHQvLyBHb3QgYW4gZXJyb3IhXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yLCByZXN0YXVyYW50KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZmlsbEJyZWFkY3J1bWIoKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmNvbnN0IGZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcblx0aWYgKHNlbGYucmVzdGF1cmFudCkgeyBcblx0XHQvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcblx0XHRjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpO1xuXHRcdHJldHVybjtcblx0fVxuXHRjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcblx0aWYgKCFpZCkgeyBcblx0XHQvLyBubyBpZCBmb3VuZCBpbiBVUkxcblx0XHRlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCc7XG5cdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHR9IGVsc2Uge1xuXHRcdERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuXHRcdFx0c2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcblx0XHRcdGlmICghcmVzdGF1cmFudCkge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0ZmlsbFJlc3RhdXJhbnRIVE1MKCk7XG5cdFx0XHRjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KTtcblx0XHR9KTtcblx0fVxufTtcblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcbiAqL1xuXG4vKiBJZiBhIGxpdmUgbWFwIGlzbid0IGFscmVhZHkgZW5hYmxlZCwgcmVtb3ZlcyB0aGUgc3RhdGljIG1hcCBpbWFnZSBhbmQgcmVwbGFjZXMgaXQgd2l0aCBhIGxpdmUgR29vZ2xlIE1hcC4gKi9cbmNvbnN0IGdldExpdmVNYXAgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuXHRpZihsaXZlTWFwKXtcblx0XHRyZXR1cm47XG5cdH0gZWxzZSB7XG5cdFx0Y29uc3Qgc3RhdGljTWFwSW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXRpYy1tYXAtaW1nJyk7XG5cdFx0c3RhdGljTWFwSW1nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3RhdGljTWFwSW1nKTtcblx0XHRzZWxmLm1hcCA9IG5ldyBnb29nbGVcblx0XHRcdC5tYXBzXG5cdFx0XHQuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuXHRcdFx0XHR6b29tOiAxNixcblx0XHRcdFx0Y2VudGVyOiBzZWxmLnJlc3RhdXJhbnQubGF0bG5nLFxuXHRcdFx0XHRzY3JvbGx3aGVlbDogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdGFkZE1hcmtlclRvTWFwKCk7XG5cdFx0bGl2ZU1hcCA9IHRydWU7XG5cdH1cbn07XG5cbmNvbnN0IGZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG5cdC8qIExvYWRzIGEgc3RhdGljIG1hcCBpbWFnZSBpZiBpdCdzIHRoZSBpbml0aWFsIHBhZ2UgbG9hZC4gQWRkcyBhIGNsaWNrIGV2ZW50IGxpc3RlbmVyIHNvIHRoYXQgd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gdGhlIG1hcCwgaXQgcmVtb3ZlcyB0aGUgc3RhdGljIG1hcCBpbWFnZSBhbmQgbG9hZHMgYSBsaXZlIG1hcCBpbiBpdHMgcGxhY2UuICovXG5cdGlmIChpbml0TG9hZCl7XG5cdFx0Y29uc3Qgc3RhdGljTWFwID0gREJIZWxwZXIuc3RhdGljSW1hZ2VGb3JNYXBSZXN0YXVyYW50SW5mbyhzZWxmLnJlc3RhdXJhbnQpO1xuXHRcdGNvbnN0IG1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcblx0XHRjb25zdCBzdGF0aWNNYXBJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcblx0XHRzdGF0aWNNYXBJbWcuaWQgPSAoJ3N0YXRpYy1tYXAtaW1nJyk7XG5cdFx0c3RhdGljTWFwSW1nLnN0eWxlLndpZHRoID0gYCR7bWFwLmNsaWVudFdpZHRofXB4YDtcblx0XHRzdGF0aWNNYXBJbWcuc3R5bGUuaGVpZ2h0ID0gYCR7bWFwLmNsaWVudEhlaWdodH1weGA7XG5cdFx0c3RhdGljTWFwSW1nLnNyYyA9IHN0YXRpY01hcDtcblx0XHRzdGF0aWNNYXBJbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0XHRnZXRMaXZlTWFwKHNlbGYucmVzdGF1cmFudCk7XG5cdFx0fSk7XG5cdFx0bWFwLmFwcGVuZENoaWxkKHN0YXRpY01hcEltZyk7XG5cdFx0YWRkTWFya2VyVG9NYXAoKTtcblx0XHRpbml0TG9hZCA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdC8vREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcblx0XHRhZGRNYXJrZXJUb01hcCgpO1xuXHR9XG5cdGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XG5cdG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXG5cdGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XG5cdGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuXG5cdC8qIExhenkgbG9hZHMgc21hbGwgb3IgbGFyZ2UgdmVyc2lvbiBvZiByZXN0YXVyYW50IGltYWdlIGJhc2VkIG9uIGRhdGEtc3Jjc2V0IGFuZCBhdXRvIGRhdGEtc2l6ZXMuIEFsc28gZHluYW1pY2FsbHkgc2V0cyBhbHQgYW5kIHRpdGxlIHRleHQgb2YgdGhlIGltYWdlLiAqL1xuXHRjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpO1xuXHRpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcgbGF6eWxvYWQnO1xuXG5cdC8qIEJhY2t1cCBjb2RlIHdpdGhvdXQgbGF6eSBsb2FkXG5cdGltYWdlLnNyYyA9IERCSGVscGVyLmxhcmdlSW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuXHRpbWFnZS5zcmNzZXQgPSBgJHtEQkhlbHBlci5zbWFsbEltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX0gNDAwdywgJHtEQkhlbHBlci5sYXJnZUltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX0gODAwd2A7XG5cdGltYWdlLnNpemVzID0gJzUwdncnOyAqL1xuXHRpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJywgYCR7REJIZWxwZXIuc21hbGxJbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCl9IDQwMHdgKTtcblx0aW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsYCR7REJIZWxwZXIuc21hbGxJbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCl9IDQwMHcsICR7REJIZWxwZXIubGFyZ2VJbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCl9IDgwMHdgKTtcblx0aW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNpemVzJywgJ2F1dG8nKTtcblx0aW1hZ2UudGl0bGUgPSBgJHtyZXN0YXVyYW50Lm5hbWV9YDtcblx0aW1hZ2UuYWx0ID0gYCR7cmVzdGF1cmFudC5uYW1lfSBpbiAke3Jlc3RhdXJhbnQubmVpZ2hib3Job29kfSAtICR7cmVzdGF1cmFudC5jdWlzaW5lX3R5cGV9IHJlc3RhdXJhbnRgO1xuXG5cdGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJyk7XG5cdGN1aXNpbmUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGU7XG5cblx0Ly8gZmlsbCBvcGVyYXRpbmcgaG91cnNcblx0aWYgKHJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XG5cdFx0ZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcblx0fVxuXHQvLyBmaWxsIHJldmlld3Ncblx0ZmlsbFJldmlld3NIVE1MKCk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNvbnN0IGZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xuXHRjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XG5cdGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuXHRcdGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG5cblx0XHRjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuXHRcdGRheS5pbm5lckhUTUwgPSBrZXk7XG5cdFx0cm93LmFwcGVuZENoaWxkKGRheSk7XG5cblx0XHRjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcblx0XHR0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG5cdFx0cm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXG5cdFx0aG91cnMuYXBwZW5kQ2hpbGQocm93KTtcblx0fVxufTtcblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNvbnN0IGZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcblx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XG5cdGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcblx0dGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xuXHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG5cdGlmICghcmV2aWV3cykge1xuXHRcdGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0XHRub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuXHRyZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcblx0XHR1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xuXHR9KTtcblx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNvbnN0IGNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XG5cdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0Y29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0bmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcblx0bGkuYXBwZW5kQ2hpbGQobmFtZSk7XG5cblx0Y29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0ZGF0ZS5pbm5lckhUTUwgPSByZXZpZXcuZGF0ZTtcblx0bGkuYXBwZW5kQ2hpbGQoZGF0ZSk7XG5cblx0Y29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRyYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XG5cdGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XG5cblx0Y29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcblx0bGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuXG5cdHJldHVybiBsaTtcbn07XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xuY29uc3QgZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Y29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG5cdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0bGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXG5cdC8vU2V0IEFSSUEgYXR0cmlidXRlcyBzbyBzY3JlZW5yZWFkZXIga25vd3MgaXRzIG9uIHRoZSBjdXJyZW50IHBhZ2UgZm9yIHRoZSByZXN0YXVyYW50IGluIHRoZSBicmVhZGNydW1iIHRyYWlsLlxuXHRsaS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCByZXN0YXVyYW50Lm5hbWUpO1xuXHRsaS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknLCAnYnJlYWRjcnVtYi1kZXNjcmlwdGlvbicpO1xuXHRsaS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcblxuXHQvL0R5bmFtaWNhbGx5IHNldCB0aXRsZSBhdHRyaWJ1dGVcblx0bGkudGl0bGUgPSByZXN0YXVyYW50Lm5hbWU7XG5cdGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xufTtcblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5jb25zdCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG5cdGlmICghdXJsKVxuXHRcdHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuXHRuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG5cdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuXHRcdHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG5cdGlmICghcmVzdWx0cylcblx0XHRyZXR1cm4gbnVsbDtcblx0aWYgKCFyZXN1bHRzWzJdKVxuXHRcdHJldHVybiAnJztcblx0cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn07XG5cbi8qKlxuICogQWRkIG1hcmtlciBmb3IgY3VycmVudCByZXN0YXVyYW50IHRvIHRoZSBtYXAuXG4gKi9cbmNvbnN0IGFkZE1hcmtlclRvTWFwID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Ly8gQWRkIG1hcmtlciB0byB0aGUgbWFwXG5cdGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcblx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmw7XG5cdH0pO1xuXHRzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xufTtcbiJdfQ==
