'use strict';

var restaurant = void 0;
var map = void 0;
var liveMap = false;
var initLoad = true;

/**
 * Initialize Google map, called from HTML.
 */
window.initMap = function () {
	fetchRestaurantFromURL(function (error, restaurant) {
		if (error) {
			// Got an error!
			console.error(error, restaurant);
		} else {
			fillBreadcrumb();
		}
	});
};

/**
 * Get current restaurant from page URL.
 */
var fetchRestaurantFromURL = function fetchRestaurantFromURL(callback) {
	if (self.restaurant) {
		// restaurant already fetched!
		callback(null, self.restaurant);
		return;
	}
	var id = getParameterByName('id');
	if (!id) {
		// no id found in URL
		var error = 'No restaurant id in URL';
		callback(error, null);
	} else {
		DBHelper.fetchRestaurantById(id, function (error, restaurant) {
			self.restaurant = restaurant;
			if (!restaurant) {
				console.error(error);
				return;
			}
			fillRestaurantHTML();
			callback(null, restaurant);
		});
	}
};

/**
 * Create restaurant HTML and add it to the webpage
 */

/* If a live map isn't already enabled, removes the static map image and replaces it with a live Google Map. */
var getLiveMap = function getLiveMap() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	if (liveMap) {
		return;
	} else {
		var staticMapImg = document.getElementById('static-map-img');
		staticMapImg.parentNode.removeChild(staticMapImg);
		self.map = new google.maps.Map(document.getElementById('map'), {
			zoom: 16,
			center: restaurant.latlng,
			scrollwheel: false
		});
		addMarkerToMap();
		liveMap = true;
	}
};

var fillRestaurantHTML = function fillRestaurantHTML() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	/* Loads a static map image if it's the initial page load. Adds a click event listener so that when the user clicks on the map, it removes the static map image and loads a live map in its place. */
	if (initLoad) {
		var staticMap = DBHelper.staticImageForMapRestaurantInfo(self.restaurant);
		var _map = document.getElementById('map');
		var staticMapImg = document.createElement('img');
		staticMapImg.id = 'static-map-img';
		staticMapImg.alt = 'Static Google Maps image';
		staticMapImg.style.width = _map.clientWidth + 'px';
		staticMapImg.style.height = _map.clientHeight + 'px';
		staticMapImg.src = staticMap;
		staticMapImg.addEventListener('click', function () {
			getLiveMap(self.restaurant);
		});
		_map.appendChild(staticMapImg);
		initLoad = false;
	} else {
		addMarkerToMap();
	}
	var name = document.getElementById('restaurant-name');
	name.innerHTML = restaurant.name;

	/* Creates a dynamic favorite button. When clicked, notifies user that restaurant favorite has been added or removed via visual cues and ARIA label changes. Also updates IDB with favorite status of the restaurant. */
	var favorite = document.getElementById('favorite-button');
	getFavoriteClass(restaurant, favorite);
	favorite.addEventListener('click', function () {
		var isFavorite = void 0;
		if (restaurant.is_favorite === 'false') {
			isFavorite = 'true';
			favorite.title = 'Remove from favorites';
			favorite.setAttribute('aria-label', 'Remove from favorites');
		} else {
			isFavorite = 'false';
			favorite.title = 'Add to favorites';
			favorite.setAttribute('aria-label', 'Add to favorites');
		}
		var restaurantId = restaurant.id;
		DBHelper.updateFavorite(restaurantId, isFavorite);
		restaurant.is_favorite = isFavorite;
		getFavoriteClass(restaurant, favorite);
	});

	/* Lazy loads small or large version of restaurant image based on data-srcset and auto data-sizes. Also dynamically sets alt and title text of the image. */
	var image = document.getElementById('restaurant-img');
	image.className = 'restaurant-img lazyload';
	image.setAttribute('data-src', DBHelper.smallImageUrlForRestaurant(restaurant) + ' 400w');
	image.setAttribute('data-srcset', DBHelper.smallImageUrlForRestaurant(restaurant) + ' 400w, ' + DBHelper.largeImageUrlForRestaurant(restaurant) + ' 800w');
	image.setAttribute('data-sizes', 'auto');
	image.title = '' + restaurant.name;
	image.alt = restaurant.name + ' in ' + restaurant.neighborhood + ' - ' + restaurant.cuisine_type + ' restaurant';

	var cuisine = document.getElementById('restaurant-cuisine');
	cuisine.innerHTML = restaurant.cuisine_type;

	var address = document.getElementById('restaurant-address');
	address.innerHTML = restaurant.address;

	// fill operating hours
	if (restaurant.operating_hours) {
		fillRestaurantHoursHTML();
	}
	// fill reviews
	DBHelper.fetchReviewsById(restaurant.id, fillReviewsHTML);
};

/**
 * Change favorite icon to appear on or off with class change.
 */
var getFavoriteClass = function getFavoriteClass(restaurant, favorite) {
	if (restaurant.is_favorite === 'true') {
		favorite.classList.add('restaurant-favorite-true');
		favorite.classList.remove('restaurant-favorite-false');
		favorite.innerHTML = '<i class="fas fa-heart"></i>';
	} else {
		favorite.classList.add('restaurant-favorite-false');
		favorite.classList.remove('restaurant-favorite-true');
		favorite.innerHTML = '<i class="far fa-heart"></i>';
	}
};

/**
 * Create restaurant operating hours HTML table and add it to the webpage.
 */
var fillRestaurantHoursHTML = function fillRestaurantHoursHTML() {
	var operatingHours = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant.operating_hours;

	var hours = document.getElementById('restaurant-hours');
	for (var key in operatingHours) {
		var row = document.createElement('tr');
		var day = document.createElement('td');
		day.innerHTML = key;
		row.appendChild(day);
		var time = document.createElement('td');
		time.innerHTML = operatingHours[key];
		row.appendChild(time);
		hours.appendChild(row);
	}
};

/**
 * Create all reviews HTML and add them to the webpage.
 */
var fillReviewsHTML = function fillReviewsHTML(error, reviews) {
	if (error) {
		console.log(error);
	}
	self.restaurant.reviews = reviews;
	var container = document.getElementById('reviews-container');
	var ul = document.getElementById('reviews-list');

	if (!reviews) {
		var noReviews = document.createElement('p');
		noReviews.id = 'no-reviews';
		noReviews.innerHTML = 'No reviews yet!';
		container.insertBefore(noReviews, ul);
	} else {
		reviews.forEach(function (review) {
			ul.appendChild(createReviewHTML(review));
		});
		container.appendChild(ul);
	}
};

/**
 * Create review HTML and add it to the webpage.
 */
var createReviewHTML = function createReviewHTML(review) {
	var li = document.createElement('li');

	/* Create label for reviews submitted while offline. */
	if (!navigator.onLine) {
		var offlineLabel = document.createElement('div');
		offlineLabel.classList.add('offline-label');
		offlineLabel.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Offline Mode - Will submit review when network connection is reestablished';
		li.appendChild(offlineLabel);
	}

	var name = document.createElement('p');
	name.classList.add('review-header');
	name.innerHTML = review.name;
	li.appendChild(name);

	/* Convert timestamp from epoch time into a more readable format. */
	var timestamp = document.createElement('p');
	timestamp.classList.add('review-header');
	var createdAtTimestamp = new Date(review.createdAt);
	var updatedAtTimestamp = new Date(review.updatedAt);
	if (createdAtTimestamp === updatedAtTimestamp) {
		timestamp.innerHTML = createdAtTimestamp.toLocaleString();
	} else {
		timestamp.innerHTML = updatedAtTimestamp.toLocaleString();
	}
	li.appendChild(timestamp);

	var rating = document.createElement('div');
	rating.classList.add('review-rating');
	if (review.rating > 1) {
		rating.title = review.rating + ' stars';
		rating.setAttribute('aria-label', review.rating + ' stars');
	} else {
		rating.title = review.rating + ' star';
		rating.setAttribute('aria-label', review.rating + ' star');
	}
	rating.innerHTML = review.rating + ' <i class="fas fa-star"></i>';
	li.appendChild(rating);

	var comments = document.createElement('p');
	comments.innerHTML = review.comments;
	li.appendChild(comments);

	return li;
};

/**
 * Add user review to the page, store in IndexedDB, and reset form.
 */
var submitReview = function submitReview() {
	event.preventDefault();
	var restaurantId = getParameterByName('id');
	var name = document.getElementById('form-name').value;
	var rating = document.querySelector('#form-rating option:checked').value;
	var comments = document.getElementById('form-comments').value;
	var review = {
		restaurant_id: parseInt(restaurantId),
		name: name,
		createdAt: new Date().getTime(),
		updatedAt: new Date().getTime(),
		rating: parseInt(rating),
		comments: comments
	};
	var ul = document.getElementById('reviews-list');
	ul.appendChild(createReviewHTML(review));
	DBHelper.addReview(review, restaurantId, fillReviewsHTML);
	document.getElementById('form').reset();
	if (!navigator.onLine) {
		console.log('Your review will be submitted when an online connection is re-established');
	} else {
		console.log('Your review has been submitted!');
	}
};

/**
 * Add restaurant name to the breadcrumb navigation menu
 */
var fillBreadcrumb = function fillBreadcrumb() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	var breadcrumb = document.getElementById('breadcrumb');
	var li = document.createElement('li');
	li.innerHTML = restaurant.name;

	//Set ARIA attributes so screenreader knows its on the current page for the restaurant in the breadcrumb trail.
	li.setAttribute('aria-label', restaurant.name);
	li.setAttribute('aria-describedby', 'breadcrumb-description');
	li.setAttribute('tabindex', '0');

	//Dynamically set title attribute
	li.title = restaurant.name;
	breadcrumb.appendChild(li);
};

/**
 * Get a parameter by name from page URL.
 */
var getParameterByName = function getParameterByName(name, url) {
	if (!url) url = window.location.href;
	name = name.replace(/[\[\]]/g, '\\$&');
	var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
	    results = regex.exec(url);
	if (!results) return null;
	if (!results[2]) return '';
	return decodeURIComponent(results[2].replace(/\+/g, ' '));
};

/**
 * Add marker for current restaurant to the map.
 */
var addMarkerToMap = function addMarkerToMap() {
	var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;

	// Add marker to the map
	var marker = DBHelper.mapMarkerForRestaurant(restaurant, self.map);
	google.maps.event.addListener(marker, 'click', function () {
		window.location.href = marker.url;
	});
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwibGl2ZU1hcCIsImluaXRMb2FkIiwid2luZG93IiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJlcnJvciIsImNvbnNvbGUiLCJmaWxsQnJlYWRjcnVtYiIsImNhbGxiYWNrIiwic2VsZiIsImlkIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiREJIZWxwZXIiLCJmZXRjaFJlc3RhdXJhbnRCeUlkIiwiZmlsbFJlc3RhdXJhbnRIVE1MIiwiZ2V0TGl2ZU1hcCIsInN0YXRpY01hcEltZyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiem9vbSIsImNlbnRlciIsImxhdGxuZyIsInNjcm9sbHdoZWVsIiwiYWRkTWFya2VyVG9NYXAiLCJzdGF0aWNNYXAiLCJzdGF0aWNJbWFnZUZvck1hcFJlc3RhdXJhbnRJbmZvIiwiY3JlYXRlRWxlbWVudCIsImFsdCIsInN0eWxlIiwid2lkdGgiLCJjbGllbnRXaWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsInNyYyIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHBlbmRDaGlsZCIsIm5hbWUiLCJpbm5lckhUTUwiLCJmYXZvcml0ZSIsImdldEZhdm9yaXRlQ2xhc3MiLCJpc0Zhdm9yaXRlIiwiaXNfZmF2b3JpdGUiLCJ0aXRsZSIsInNldEF0dHJpYnV0ZSIsInJlc3RhdXJhbnRJZCIsInVwZGF0ZUZhdm9yaXRlIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzbWFsbEltYWdlVXJsRm9yUmVzdGF1cmFudCIsImxhcmdlSW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwibmVpZ2hib3Job29kIiwiY3Vpc2luZV90eXBlIiwiY3Vpc2luZSIsImFkZHJlc3MiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZldGNoUmV2aWV3c0J5SWQiLCJmaWxsUmV2aWV3c0hUTUwiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwidGltZSIsInJldmlld3MiLCJsb2ciLCJjb250YWluZXIiLCJ1bCIsIm5vUmV2aWV3cyIsImluc2VydEJlZm9yZSIsImZvckVhY2giLCJjcmVhdGVSZXZpZXdIVE1MIiwicmV2aWV3IiwibGkiLCJuYXZpZ2F0b3IiLCJvbkxpbmUiLCJvZmZsaW5lTGFiZWwiLCJ0aW1lc3RhbXAiLCJjcmVhdGVkQXRUaW1lc3RhbXAiLCJEYXRlIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0VGltZXN0YW1wIiwidXBkYXRlZEF0IiwidG9Mb2NhbGVTdHJpbmciLCJyYXRpbmciLCJjb21tZW50cyIsInN1Ym1pdFJldmlldyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsInF1ZXJ5U2VsZWN0b3IiLCJyZXN0YXVyYW50X2lkIiwicGFyc2VJbnQiLCJnZXRUaW1lIiwiYWRkUmV2aWV3IiwicmVzZXQiLCJicmVhZGNydW1iIiwidXJsIiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsInJlZ2V4IiwiUmVnRXhwIiwicmVzdWx0cyIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJtYXJrZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiYWRkTGlzdGVuZXIiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsbUJBQUo7QUFDQSxJQUFJQyxZQUFKO0FBQ0EsSUFBSUMsVUFBVSxLQUFkO0FBQ0EsSUFBSUMsV0FBVyxJQUFmOztBQUVBOzs7QUFHQUMsT0FBT0MsT0FBUCxHQUFpQixZQUFNO0FBQ3RCQyx3QkFBdUIsVUFBQ0MsS0FBRCxFQUFRUCxVQUFSLEVBQXVCO0FBQzdDLE1BQUlPLEtBQUosRUFBVztBQUNWO0FBQ0FDLFdBQVFELEtBQVIsQ0FBY0EsS0FBZCxFQUFxQlAsVUFBckI7QUFDQSxHQUhELE1BR087QUFDTlM7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QUosVUFBa0JyRSxJQUFsQix1QkFBZDtBQUFBLEtBQ0NzRSxVQUFVRixNQUFNRyxJQUFOLENBQVdQLEdBQVgsQ0FEWDtBQUVBLEtBQUksQ0FBQ00sT0FBTCxFQUNDLE9BQU8sSUFBUDtBQUNELEtBQUksQ0FBQ0EsUUFBUSxDQUFSLENBQUwsRUFDQyxPQUFPLEVBQVA7QUFDRCxRQUFPRSxtQkFBbUJGLFFBQVEsQ0FBUixFQUFXSCxPQUFYLENBQW1CLEtBQW5CLEVBQTBCLEdBQTFCLENBQW5CLENBQVA7QUFDQSxDQVhEOztBQWFBOzs7QUFHQSxJQUFNaEYsaUJBQWlCLFNBQWpCQSxjQUFpQixHQUFrQztBQUFBLEtBQWpDOUIsVUFBaUMsdUVBQXBCVyxLQUFLWCxVQUFlOztBQUN4RDtBQUNBLEtBQU1vSCxTQUFTdEcsU0FBU3VHLHNCQUFULENBQWdDckgsVUFBaEMsRUFBNENXLEtBQUtWLEdBQWpELENBQWY7QUFDQXNCLFFBQU9DLElBQVAsQ0FBWXlFLEtBQVosQ0FBa0JxQixXQUFsQixDQUE4QkYsTUFBOUIsRUFBc0MsT0FBdEMsRUFBK0MsWUFBTTtBQUNwRGhILFNBQU93RyxRQUFQLENBQWdCQyxJQUFoQixHQUF1Qk8sT0FBT1QsR0FBOUI7QUFDQSxFQUZEO0FBR0EsQ0FORCIsImZpbGUiOiJyZXN0YXVyYW50X2luZm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudDtcbmxldCBtYXA7XG5sZXQgbGl2ZU1hcCA9IGZhbHNlO1xubGV0IGluaXRMb2FkID0gdHJ1ZTtcblxuLyoqXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXG4gKi9cbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuXHRmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuXHRcdGlmIChlcnJvcikgeyBcblx0XHRcdC8vIEdvdCBhbiBlcnJvciFcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IsIHJlc3RhdXJhbnQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRmaWxsQnJlYWRjcnVtYigpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xuY29uc3QgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xuXHRpZiAoc2VsZi5yZXN0YXVyYW50KSB7IFxuXHRcdC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxuXHRcdGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuXHRpZiAoIWlkKSB7IFxuXHRcdC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuXHRcdGNvbnN0IGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJztcblx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdH0gZWxzZSB7XG5cdFx0REJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG5cdFx0XHRzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xuXHRcdFx0aWYgKCFyZXN0YXVyYW50KSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRmaWxsUmVzdGF1cmFudEhUTUwoKTtcblx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuXHRcdH0pO1xuXHR9XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5cbi8qIElmIGEgbGl2ZSBtYXAgaXNuJ3QgYWxyZWFkeSBlbmFibGVkLCByZW1vdmVzIHRoZSBzdGF0aWMgbWFwIGltYWdlIGFuZCByZXBsYWNlcyBpdCB3aXRoIGEgbGl2ZSBHb29nbGUgTWFwLiAqL1xuY29uc3QgZ2V0TGl2ZU1hcCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG5cdGlmKGxpdmVNYXApe1xuXHRcdHJldHVybjtcblx0fSBlbHNlIHtcblx0XHRjb25zdCBzdGF0aWNNYXBJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdGljLW1hcC1pbWcnKTtcblx0XHRzdGF0aWNNYXBJbWcucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdGF0aWNNYXBJbWcpO1xuXHRcdHNlbGYubWFwID0gbmV3IGdvb2dsZVxuXHRcdFx0Lm1hcHNcblx0XHRcdC5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG5cdFx0XHRcdHpvb206IDE2LFxuXHRcdFx0XHRjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxuXHRcdFx0XHRzY3JvbGx3aGVlbDogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdGFkZE1hcmtlclRvTWFwKCk7XG5cdFx0bGl2ZU1hcCA9IHRydWU7XG5cdH1cbn07XG5cbmNvbnN0IGZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG5cdC8qIExvYWRzIGEgc3RhdGljIG1hcCBpbWFnZSBpZiBpdCdzIHRoZSBpbml0aWFsIHBhZ2UgbG9hZC4gQWRkcyBhIGNsaWNrIGV2ZW50IGxpc3RlbmVyIHNvIHRoYXQgd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gdGhlIG1hcCwgaXQgcmVtb3ZlcyB0aGUgc3RhdGljIG1hcCBpbWFnZSBhbmQgbG9hZHMgYSBsaXZlIG1hcCBpbiBpdHMgcGxhY2UuICovXG5cdGlmIChpbml0TG9hZCl7XG5cdFx0Y29uc3Qgc3RhdGljTWFwID0gREJIZWxwZXIuc3RhdGljSW1hZ2VGb3JNYXBSZXN0YXVyYW50SW5mbyhzZWxmLnJlc3RhdXJhbnQpO1xuXHRcdGNvbnN0IG1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcblx0XHRjb25zdCBzdGF0aWNNYXBJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcblx0XHRzdGF0aWNNYXBJbWcuaWQgPSAnc3RhdGljLW1hcC1pbWcnO1xuXHRcdHN0YXRpY01hcEltZy5hbHQgPSAnU3RhdGljIEdvb2dsZSBNYXBzIGltYWdlJztcblx0XHRzdGF0aWNNYXBJbWcuc3R5bGUud2lkdGggPSBgJHttYXAuY2xpZW50V2lkdGh9cHhgO1xuXHRcdHN0YXRpY01hcEltZy5zdHlsZS5oZWlnaHQgPSBgJHttYXAuY2xpZW50SGVpZ2h0fXB4YDtcblx0XHRzdGF0aWNNYXBJbWcuc3JjID0gc3RhdGljTWFwO1xuXHRcdHN0YXRpY01hcEltZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdGdldExpdmVNYXAoc2VsZi5yZXN0YXVyYW50KTtcblx0XHR9KTtcblx0XHRtYXAuYXBwZW5kQ2hpbGQoc3RhdGljTWFwSW1nKTtcblx0XHRpbml0TG9hZCA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdGFkZE1hcmtlclRvTWFwKCk7XG5cdH1cblx0Y29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcblx0bmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG5cblx0LyogQ3JlYXRlcyBhIGR5bmFtaWMgZmF2b3JpdGUgYnV0dG9uLiBXaGVuIGNsaWNrZWQsIG5vdGlmaWVzIHVzZXIgdGhhdCByZXN0YXVyYW50IGZhdm9yaXRlIGhhcyBiZWVuIGFkZGVkIG9yIHJlbW92ZWQgdmlhIHZpc3VhbCBjdWVzIGFuZCBBUklBIGxhYmVsIGNoYW5nZXMuIEFsc28gdXBkYXRlcyBJREIgd2l0aCBmYXZvcml0ZSBzdGF0dXMgb2YgdGhlIHJlc3RhdXJhbnQuICovXG5cdGNvbnN0IGZhdm9yaXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zhdm9yaXRlLWJ1dHRvbicpO1xuXHRnZXRGYXZvcml0ZUNsYXNzKHJlc3RhdXJhbnQsIGZhdm9yaXRlKTtcblx0ZmF2b3JpdGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0bGV0IGlzRmF2b3JpdGU7XG5cdFx0aWYocmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PT0gJ2ZhbHNlJyl7XG5cdFx0XHRpc0Zhdm9yaXRlID0gJ3RydWUnO1xuXHRcdFx0ZmF2b3JpdGUudGl0bGUgPSAnUmVtb3ZlIGZyb20gZmF2b3JpdGVzJztcblx0XHRcdGZhdm9yaXRlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdSZW1vdmUgZnJvbSBmYXZvcml0ZXMnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aXNGYXZvcml0ZSA9ICdmYWxzZSc7XG5cdFx0XHRmYXZvcml0ZS50aXRsZSA9ICdBZGQgdG8gZmF2b3JpdGVzJztcblx0XHRcdGZhdm9yaXRlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdBZGQgdG8gZmF2b3JpdGVzJyk7XG5cdFx0fVxuXHRcdGNvbnN0IHJlc3RhdXJhbnRJZCA9IHJlc3RhdXJhbnQuaWQ7XG5cdFx0REJIZWxwZXIudXBkYXRlRmF2b3JpdGUocmVzdGF1cmFudElkLCBpc0Zhdm9yaXRlKTtcblx0XHRyZXN0YXVyYW50LmlzX2Zhdm9yaXRlID0gaXNGYXZvcml0ZTtcblx0XHRnZXRGYXZvcml0ZUNsYXNzKHJlc3RhdXJhbnQsIGZhdm9yaXRlKTtcblx0fSk7XG5cblx0LyogTGF6eSBsb2FkcyBzbWFsbCBvciBsYXJnZSB2ZXJzaW9uIG9mIHJlc3RhdXJhbnQgaW1hZ2UgYmFzZWQgb24gZGF0YS1zcmNzZXQgYW5kIGF1dG8gZGF0YS1zaXplcy4gQWxzbyBkeW5hbWljYWxseSBzZXRzIGFsdCBhbmQgdGl0bGUgdGV4dCBvZiB0aGUgaW1hZ2UuICovXG5cdGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XG5cdGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyBsYXp5bG9hZCc7XG5cdGltYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmMnLCBgJHtEQkhlbHBlci5zbWFsbEltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX0gNDAwd2ApO1xuXHRpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JyxgJHtEQkhlbHBlci5zbWFsbEltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX0gNDAwdywgJHtEQkhlbHBlci5sYXJnZUltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KX0gODAwd2ApO1xuXHRpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2l6ZXMnLCAnYXV0bycpO1xuXHRpbWFnZS50aXRsZSA9IGAke3Jlc3RhdXJhbnQubmFtZX1gO1xuXHRpbWFnZS5hbHQgPSBgJHtyZXN0YXVyYW50Lm5hbWV9IGluICR7cmVzdGF1cmFudC5uZWlnaGJvcmhvb2R9IC0gJHtyZXN0YXVyYW50LmN1aXNpbmVfdHlwZX0gcmVzdGF1cmFudGA7XG5cblx0Y29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcblx0Y3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuXHRjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuXHRhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblxuXHQvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuXHRpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcblx0XHRmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuXHR9XG5cdC8vIGZpbGwgcmV2aWV3c1xuXHREQkhlbHBlci5mZXRjaFJldmlld3NCeUlkKHJlc3RhdXJhbnQuaWQsIGZpbGxSZXZpZXdzSFRNTCk7XG59O1xuXG4vKipcbiAqIENoYW5nZSBmYXZvcml0ZSBpY29uIHRvIGFwcGVhciBvbiBvciBvZmYgd2l0aCBjbGFzcyBjaGFuZ2UuXG4gKi9cbmNvbnN0IGdldEZhdm9yaXRlQ2xhc3MgPSAocmVzdGF1cmFudCwgZmF2b3JpdGUpID0+IHtcblx0aWYgKHJlc3RhdXJhbnQuaXNfZmF2b3JpdGUgPT09ICd0cnVlJyl7XG5cdFx0ZmF2b3JpdGUuY2xhc3NMaXN0LmFkZCgncmVzdGF1cmFudC1mYXZvcml0ZS10cnVlJyk7XG5cdFx0ZmF2b3JpdGUuY2xhc3NMaXN0LnJlbW92ZSgncmVzdGF1cmFudC1mYXZvcml0ZS1mYWxzZScpO1xuXHRcdGZhdm9yaXRlLmlubmVySFRNTCA9ICc8aSBjbGFzcz1cImZhcyBmYS1oZWFydFwiPjwvaT4nO1xuXHR9IGVsc2Uge1xuXHRcdGZhdm9yaXRlLmNsYXNzTGlzdC5hZGQoJ3Jlc3RhdXJhbnQtZmF2b3JpdGUtZmFsc2UnKTtcblx0XHRmYXZvcml0ZS5jbGFzc0xpc3QucmVtb3ZlKCdyZXN0YXVyYW50LWZhdm9yaXRlLXRydWUnKTtcblx0XHRmYXZvcml0ZS5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJmYXIgZmEtaGVhcnRcIj48L2k+Jztcblx0fVxufTtcblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jb25zdCBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcblx0Y29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuXHRmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcblx0XHRjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXHRcdGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG5cdFx0ZGF5LmlubmVySFRNTCA9IGtleTtcblx0XHRyb3cuYXBwZW5kQ2hpbGQoZGF5KTtcblx0XHRjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcblx0XHR0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG5cdFx0cm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXHRcdGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XG5cdH1cbn07XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jb25zdCBmaWxsUmV2aWV3c0hUTUwgPSAoZXJyb3IsIHJldmlld3MpID0+IHtcblx0aWYoZXJyb3Ipe1xuXHRcdGNvbnNvbGUubG9nKGVycm9yKTtcblx0fVxuXHRzZWxmLnJlc3RhdXJhbnQucmV2aWV3cyA9IHJldmlld3M7XG5cdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xuXHRjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcblxuXHRpZiAoIXJldmlld3MpIHtcblx0XHRjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdFx0bm9SZXZpZXdzLmlkID0gJ25vLXJldmlld3MnO1xuXHRcdG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcblx0XHRjb250YWluZXIuaW5zZXJ0QmVmb3JlKG5vUmV2aWV3cywgdWwpO1xuXHR9IGVsc2Uge1xuXHRcdHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xuXHRcdFx0dWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcblx0XHR9KTtcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xuXHR9XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jb25zdCBjcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xuXHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cblx0LyogQ3JlYXRlIGxhYmVsIGZvciByZXZpZXdzIHN1Ym1pdHRlZCB3aGlsZSBvZmZsaW5lLiAqL1xuXHRpZiAoIW5hdmlnYXRvci5vbkxpbmUpIHtcblx0XHRjb25zdCBvZmZsaW5lTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRvZmZsaW5lTGFiZWwuY2xhc3NMaXN0LmFkZCgnb2ZmbGluZS1sYWJlbCcpO1xuXHRcdG9mZmxpbmVMYWJlbC5pbm5lckhUTUwgPSBgPGkgY2xhc3M9XCJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIj48L2k+IE9mZmxpbmUgTW9kZSAtIFdpbGwgc3VibWl0IHJldmlldyB3aGVuIG5ldHdvcmsgY29ubmVjdGlvbiBpcyByZWVzdGFibGlzaGVkYDtcblx0XHRsaS5hcHBlbmRDaGlsZChvZmZsaW5lTGFiZWwpO1xuXHR9XG5cblx0Y29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0bmFtZS5jbGFzc0xpc3QuYWRkKCdyZXZpZXctaGVhZGVyJyk7XG5cdG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XG5cdGxpLmFwcGVuZENoaWxkKG5hbWUpO1xuXG5cdC8qIENvbnZlcnQgdGltZXN0YW1wIGZyb20gZXBvY2ggdGltZSBpbnRvIGEgbW9yZSByZWFkYWJsZSBmb3JtYXQuICovXG5cdGNvbnN0IHRpbWVzdGFtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0dGltZXN0YW1wLmNsYXNzTGlzdC5hZGQoJ3Jldmlldy1oZWFkZXInKTtcblx0Y29uc3QgY3JlYXRlZEF0VGltZXN0YW1wID0gbmV3IERhdGUocmV2aWV3LmNyZWF0ZWRBdCk7XG5cdGNvbnN0IHVwZGF0ZWRBdFRpbWVzdGFtcCA9IG5ldyBEYXRlKHJldmlldy51cGRhdGVkQXQpO1xuXHRpZiAoY3JlYXRlZEF0VGltZXN0YW1wID09PSB1cGRhdGVkQXRUaW1lc3RhbXApe1xuXHRcdHRpbWVzdGFtcC5pbm5lckhUTUwgPSBjcmVhdGVkQXRUaW1lc3RhbXAudG9Mb2NhbGVTdHJpbmcoKTtcblx0fSBlbHNlIHtcblx0XHR0aW1lc3RhbXAuaW5uZXJIVE1MID0gdXBkYXRlZEF0VGltZXN0YW1wLnRvTG9jYWxlU3RyaW5nKCk7XG5cdH1cblx0bGkuYXBwZW5kQ2hpbGQodGltZXN0YW1wKTtcblxuXHRjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0cmF0aW5nLmNsYXNzTGlzdC5hZGQoJ3Jldmlldy1yYXRpbmcnKTtcblx0aWYgKHJldmlldy5yYXRpbmcgPiAxKXtcblx0XHRyYXRpbmcudGl0bGUgPSBgJHtyZXZpZXcucmF0aW5nfSBzdGFyc2A7XG5cdFx0cmF0aW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGAke3Jldmlldy5yYXRpbmd9IHN0YXJzYCk7XG5cdH0gZWxzZSB7XG5cdFx0cmF0aW5nLnRpdGxlID0gYCR7cmV2aWV3LnJhdGluZ30gc3RhcmA7XG5cdFx0cmF0aW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGAke3Jldmlldy5yYXRpbmd9IHN0YXJgKTtcblx0fVxuXHRyYXRpbmcuaW5uZXJIVE1MID0gYCR7cmV2aWV3LnJhdGluZ30gPGkgY2xhc3M9XCJmYXMgZmEtc3RhclwiPjwvaT5gO1xuXHRsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xuXG5cdGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XG5cdGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcblxuXHRyZXR1cm4gbGk7XG59O1xuXG4vKipcbiAqIEFkZCB1c2VyIHJldmlldyB0byB0aGUgcGFnZSwgc3RvcmUgaW4gSW5kZXhlZERCLCBhbmQgcmVzZXQgZm9ybS5cbiAqL1xuY29uc3Qgc3VibWl0UmV2aWV3ID0gKCkgPT4ge1xuXHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRjb25zdCByZXN0YXVyYW50SWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG5cdGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1uYW1lJykudmFsdWU7XG5cdGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmb3JtLXJhdGluZyBvcHRpb246Y2hlY2tlZCcpLnZhbHVlO1xuXHRjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtLWNvbW1lbnRzJykudmFsdWU7XG5cdGNvbnN0IHJldmlldyA9IHtcblx0XHRyZXN0YXVyYW50X2lkOiBwYXJzZUludChyZXN0YXVyYW50SWQpLFxuXHRcdG5hbWU6IG5hbWUsXG5cdFx0Y3JlYXRlZEF0OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcblx0XHR1cGRhdGVkQXQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuXHRcdHJhdGluZzogcGFyc2VJbnQocmF0aW5nKSxcblx0XHRjb21tZW50czogY29tbWVudHNcblx0fTtcblx0Y29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XG5cdHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XG5cdERCSGVscGVyLmFkZFJldmlldyhyZXZpZXcsIHJlc3RhdXJhbnRJZCwgZmlsbFJldmlld3NIVE1MKTtcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm0nKS5yZXNldCgpO1xuXHRpZighbmF2aWdhdG9yLm9uTGluZSl7XG5cdFx0Y29uc29sZS5sb2coJ1lvdXIgcmV2aWV3IHdpbGwgYmUgc3VibWl0dGVkIHdoZW4gYW4gb25saW5lIGNvbm5lY3Rpb24gaXMgcmUtZXN0YWJsaXNoZWQnKTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLmxvZygnWW91ciByZXZpZXcgaGFzIGJlZW4gc3VibWl0dGVkIScpO1xuXHR9XG59O1xuXG4vKipcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XG4gKi9cbmNvbnN0IGZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Y29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG5cdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0bGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXG5cdC8vU2V0IEFSSUEgYXR0cmlidXRlcyBzbyBzY3JlZW5yZWFkZXIga25vd3MgaXRzIG9uIHRoZSBjdXJyZW50IHBhZ2UgZm9yIHRoZSByZXN0YXVyYW50IGluIHRoZSBicmVhZGNydW1iIHRyYWlsLlxuXHRsaS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCByZXN0YXVyYW50Lm5hbWUpO1xuXHRsaS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknLCAnYnJlYWRjcnVtYi1kZXNjcmlwdGlvbicpO1xuXHRsaS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcblxuXHQvL0R5bmFtaWNhbGx5IHNldCB0aXRsZSBhdHRyaWJ1dGVcblx0bGkudGl0bGUgPSByZXN0YXVyYW50Lm5hbWU7XG5cdGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xufTtcblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5jb25zdCBnZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG5cdGlmICghdXJsKVxuXHRcdHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuXHRuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG5cdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuXHRcdHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG5cdGlmICghcmVzdWx0cylcblx0XHRyZXR1cm4gbnVsbDtcblx0aWYgKCFyZXN1bHRzWzJdKVxuXHRcdHJldHVybiAnJztcblx0cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn07XG5cbi8qKlxuICogQWRkIG1hcmtlciBmb3IgY3VycmVudCByZXN0YXVyYW50IHRvIHRoZSBtYXAuXG4gKi9cbmNvbnN0IGFkZE1hcmtlclRvTWFwID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcblx0Ly8gQWRkIG1hcmtlciB0byB0aGUgbWFwXG5cdGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcblx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmw7XG5cdH0pO1xufTtcblxuIl19
